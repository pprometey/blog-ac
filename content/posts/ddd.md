+++ 
draft = true
date = 2021-03-05T17:25:33+06:00
title = "Domain-Driven Design"
description = "Предметно-ориентированое проектирование приложений"
slug = ""
authors = []
tags = []
categories = []
externalLink = ""
series = []
+++

## Стратегические шаблоны

единый язык, предметная область, предметная подобласть, смысловое ядро, ограниченный контекст, карта контекстов

Предметная область (Domain) – деятельность какой-либо организация и среда, в которой она реализует эту деятельность. 
Предметные подобласти (Subdomain)  - логические части предметной области разделенные по их функциональности. 

Смысловое ядро (Core domain) – это подобласть, имеющая первостепенное значение деятельности организации. Смысловое ядро описывает стратегическую состовляющую деятельности бизнеса. Это конкурентное преимущество компании, то, на чём эта компания зарабатывает деньги, чем она отличается от конкурентов, её ноу-хау

Служебная подобласти (Supporting subdomain) - модель описывающая специализированный аспект деятельности бизнеса, важный для деятельности организации, но не входящий в смысловое ядро. То, без чего нельзя, но это не является каким-то ноу-хау, реальным конкурентным преимуществом. Это то, что поддерживает Core Subdomain

Неспециализированной подобласть (Generic subdomain) - модель описывающая аспект деятельности организации, которая требуется для всего бизнеса в целом, и не имеет какой-либо конкретной специализации. 

Подобласти важны для успеха бизнеса, но не имеют первоочередного значения. 

Торговая компания: 
Домен - оптовая-розничная торговля товарами
Поддомены: Обработка заказов, закуп товаров,  маркетинг и реклама, хранение, доставка, бухгалтерия, ИТ.

Единный язык  (Ubiquitous Language) - специализированный язык предметной области для которой разрабатыавется ПО

Ограниченный контекст (Bounded context) - граница, в пределах которой понятия единого языка имеют вполне конкретное контекстное значение, т.е. когда в предметной области смысл определенного термина или фразы может сильно отличаться. 
Итак, ограниченный контекст – это явная граница, внутри которой существует модель предметной области, которая отображает единый язык в модель программного обеспечения.
В каждом ограниченном контексте существует только один единый язык
Язык является единым только в рамках команды, работающей над проектом в едином ограниченном контексте.


Subdomain - это задачи бизнеса. А Bounded Context - это программное решение этих задач. 
Пример: Бухгалтерия - это subdomain, а 1С Бухгалтерия - это Bounded Context. 
В процессе выполнения проектов происходит некий маппинг Subdomain’ов на bounded context’ы

Это и есть основа для стратегического проектирования при подходе DDD.

## Тактические шаблоны DDD

Сущность (Entity) - Идентифицируемый, изменяемыйй объект. Сравниваются по идентификатору, даже если все другие значения полей одинковы. Изменяются. 

Объект-Значение (Value Object) - сравниваются по значению полей. имеют нулевой жизненный цикл. Неизменяемые

Служба Предметной Области (Domain Service) - Используя единый язык, существительные этого языка отражаются в объекты, а глаголы отражаются в поведения этих объектов. Очень часто существуют глаголы или какие-то действия, которые нельзя отнести к какой-то сущности или к какому-то объекту-значению. Если существует такого рода операция в предметной области, ее объявляют как служба предметной области.службу перевода денег с одного счета плательщика в счет получателя.  Совершенно неясно, в каком объекте хранить метод перевода, поэтому используется служба

Доменные события (Domain Events) доменное  событие – это то, что случилось в прошедшем времени. Поэтому имя события отражает прошлое время, при этом само имя должно присваиваться в соответствии с единым языком в ограниченном контексте. Событие моделируется как объект, интерфейс которого выражает его предназначение, а свойства отражают его причину.

Модуль (Module) Модули внутри модели являются именованными контейнерами для некоторой группы объектов предметной области, тесно связанных друг с другом

Агрегат (Aggregate) Агрегатом называется кластер из объектов сущностей или значений. То есть эти объекты рассматриваются как единое целое с точки зрения изменения данных.
У каждого агрегата есть корень (Aggregate Root) и граница, внутри которой всегда должны быть удовлетворены инварианты.
Все обращения к агрегату должны осуществляться через его корень, который представляет собой сущность с глобально уникальным идентификатором. Все внутренние объекты агрегата имеют только локальную идентичность, они могут ссылаться друг на друга как угодно. Внешние объекты могут хранить только ссылку на корень, а не на внутренние объекты.

Фабрика (Factory) Фабрики – элементы программы, обязанности которого создавать другие объекты. Объекты-значения и сущности создаются по-разному: так как значения неизменяемы, все атрибуты должны передаваться сразу при создании. А в сущность можно добавлять только те, которые важны для создания конкретного агрегата и его инвариантов.

Чаще всего фабрики проектируются как фабричный метод в корне агрегата. Фабричный метод еще выгоден тем, что с его помощью можно выразить единый язык (конструктор же не выражает это).

Хранилища (Repository) Хранилище используется для агрегатов. Помещая агрегат в соответствующее хранилище, а затем извлекая его оттуда, вы получаете целостный объект. Если агрегат будет изменен, то изменения будут сохранены. Если агрегат будет удален, то его уже нельзя будет извлечь

Ссылки: 
- https://habr.com/ru/company/jugru/blog/440772/
- https://habr.com/ru/post/61524/
- https://docs.microsoft.com/en-us/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/
- https://habr.com/ru/post/275599/
- https://habr.com/ru/post/432410/
- https://www.youtube.com/watch?v=qJPwSvDLmQE
- https://habrahabr.ru/post/316438/
- https://habr.com/ru/post/316890/
- https://www.thereformedprogrammer.net/is-the-repository-pattern-useful-with-entity-framework-core/